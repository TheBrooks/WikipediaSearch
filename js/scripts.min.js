/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// identity function for calling harmony imports with the correct context
/******/ 	__webpack_require__.i = function(value) { return value; };
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 3);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

var events = {
  events: {},
  subscribe: function (eventName, fn) {
    this.events[eventName] = this.events[eventName] || [];
    this.events[eventName].push(fn);
  },
  unsubscribe: function(eventName, fn) {
    if (this.events[eventName]) {
      for (var i = 0; i < this.events[eventName].length; i++) {
        if (this.events[eventName][i] === fn) {
          this.events[eventName].splice(i, 1);
          break;
        }
      };
    }
  },
  emit: function (eventName, data) {
    if (this.events[eventName]) {
      this.events[eventName].forEach(function(fn) {
        fn(data);
      });
    }
  }
};

module.exports = events;

/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

(function($, window, document) {
	var events = __webpack_require__(0);

	var wikiPageJsonFormatter = (function(){
		function pagesFromWikiJson(json) {
			var pages = json.query.pages;
			var formattedPages = [];
			for(var prop in pages) {
				var newPage = {
					title: pages[prop].title,
					description: pages[prop].extract,
					url: "http://en.wikipedia.org/?curid=" + pages[prop].pageid,
				};
				formattedPages.push(newPage);
			}
			return formattedPages;
		}

		return {
			pagesFromWikiJson: pagesFromWikiJson,
		};
	})();

	var wikiSearcher = (function(wikiJsonFormatter){
		var offset = 0;
		var limit = 10;
		var search = "";
		var apiBase = "https://en.wikipedia.org/w/api.php?format=json&action=query&generator=search&gsrnamespace=0&prop=extracts&exintro&explaintext&exsentences=1&exlimit=max"
		var limitParam = "&gsrlimit=";
		var offsetParam = "&gsroffset=";
		var searchParam = "&gsrsearch=";

		//Cache DOM
		var $search = $("#search-text");

		//bind events
		$search.on('search', searchFired);
		events.subscribe('bottomOfPage', bottomOfPage);

		function searchFired() {
			offset = 0;
			search = $search.val();
			clearSearch();
			getNextWikipediaQuery();
		}

		function clearSearch() {
			events.emit("clearSearch", []);
		}

		function getNextWikipediaQuery() {
			if (!search) {
				return;
			}

			var queryStr = apiBase + limitParam + limit + offsetParam + offset + searchParam + search;
			var query = $.getJSON(queryStr);
			events.emit('queriedPages', null);
			// TODO handle error
			query.done(handleWikipediaData);
		}

		function handleWikipediaData(data) {
			var pages = wikiJsonFormatter.pagesFromWikiJson(data);
			offset += pages.length;
			events.emit("updateQueryResults", pages);
		}

		function bottomOfPage(){
			getNextWikipediaQuery();
		}
	})(wikiPageJsonFormatter);


	var pageViewer = (function(){
		var pages = [];

		//cache DOM
		var $ul = $("#result-list");
		var template = $ul.find("#page-template").html();

		//bind events
		events.subscribe('updateQueryResults', addPages);
		events.subscribe('clearSearch', clearPages);
		_render();

		function _render() {
			$ul.html(Mustache.render(template, {pages: pages}));
		}

		function addPages(value) {
			pages = pages.concat(value);
			events.emit('addedPages', null);
			_render();
		}

		function clearPages() {
			pages = [];
			_render();
		}

		return {
			addPages: addPages,
			clearPages: clearPages,
		};
	})();
}(window.jQuery, window, document));

/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

(function($, window, document) {	
	var events = __webpack_require__(0);

	var scroll = (function(){
		var win = $(window);

		//cache DOM
		var $loading = $('#loading');

		//Bind events
		win.scroll(checkBottomOfPage);
		events.subscribe('addedPages', hideLoading);
		events.subscribe('queriedPages', showLoading);

		function checkBottomOfPage() {
			if ($(document).height() - win.height() == win.scrollTop()) {
				events.emit("bottomOfPage", null);
			}
		}

		function showLoading() {
			$loading.show();
		}

		function hideLoading() {
			$loading.hide();
		}
	})();
}(window.jQuery, window, document));

/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(2);
__webpack_require__(1);


/***/ })
/******/ ]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgN2IxNDBjNTc1YjQ4MmMzZmIyNTYiLCJ3ZWJwYWNrOi8vLy4vanMvcHVic3ViLmpzIiwid2VicGFjazovLy8uL2pzL3NjcmlwdC5qcyIsIndlYnBhY2s6Ly8vLi9qcy9zY3JvbGwuanMiLCJ3ZWJwYWNrOi8vLy4vanMvc2NyaXB0cy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsbURBQTJDLGNBQWM7O0FBRXpEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsbUNBQTJCLDBCQUEwQixFQUFFO0FBQ3ZELHlDQUFpQyxlQUFlO0FBQ2hEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDhEQUFzRCwrREFBK0Q7O0FBRXJIO0FBQ0E7O0FBRUE7QUFDQTs7Ozs7OztBQ2hFQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLHFCQUFxQixtQ0FBbUM7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTs7QUFFQSx3Qjs7Ozs7O0FDekJBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOzs7QUFHRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHVDQUF1QyxhQUFhO0FBQ3BEOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0YsQ0FBQyxtQzs7Ozs7O0FDMUdELGdDO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRixDQUFDLG1DOzs7Ozs7QUM1QkQ7QUFDQSIsImZpbGUiOiJzY3JpcHRzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0XG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDMpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIDdiMTQwYzU3NWI0ODJjM2ZiMjU2IiwidmFyIGV2ZW50cyA9IHtcbiAgZXZlbnRzOiB7fSxcbiAgc3Vic2NyaWJlOiBmdW5jdGlvbiAoZXZlbnROYW1lLCBmbikge1xuICAgIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0gPSB0aGlzLmV2ZW50c1tldmVudE5hbWVdIHx8IFtdO1xuICAgIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0ucHVzaChmbik7XG4gIH0sXG4gIHVuc3Vic2NyaWJlOiBmdW5jdGlvbihldmVudE5hbWUsIGZuKSB7XG4gICAgaWYgKHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0pIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ldmVudHNbZXZlbnROYW1lXS5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAodGhpcy5ldmVudHNbZXZlbnROYW1lXVtpXSA9PT0gZm4pIHtcbiAgICAgICAgICB0aGlzLmV2ZW50c1tldmVudE5hbWVdLnNwbGljZShpLCAxKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH0sXG4gIGVtaXQ6IGZ1bmN0aW9uIChldmVudE5hbWUsIGRhdGEpIHtcbiAgICBpZiAodGhpcy5ldmVudHNbZXZlbnROYW1lXSkge1xuICAgICAgdGhpcy5ldmVudHNbZXZlbnROYW1lXS5mb3JFYWNoKGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgIGZuKGRhdGEpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGV2ZW50cztcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2pzL3B1YnN1Yi5qc1xuLy8gbW9kdWxlIGlkID0gMFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCIoZnVuY3Rpb24oJCwgd2luZG93LCBkb2N1bWVudCkge1xuXHR2YXIgZXZlbnRzID0gcmVxdWlyZSgnLi9wdWJzdWIuanMnKTtcblxuXHR2YXIgd2lraVBhZ2VKc29uRm9ybWF0dGVyID0gKGZ1bmN0aW9uKCl7XG5cdFx0ZnVuY3Rpb24gcGFnZXNGcm9tV2lraUpzb24oanNvbikge1xuXHRcdFx0dmFyIHBhZ2VzID0ganNvbi5xdWVyeS5wYWdlcztcblx0XHRcdHZhciBmb3JtYXR0ZWRQYWdlcyA9IFtdO1xuXHRcdFx0Zm9yKHZhciBwcm9wIGluIHBhZ2VzKSB7XG5cdFx0XHRcdHZhciBuZXdQYWdlID0ge1xuXHRcdFx0XHRcdHRpdGxlOiBwYWdlc1twcm9wXS50aXRsZSxcblx0XHRcdFx0XHRkZXNjcmlwdGlvbjogcGFnZXNbcHJvcF0uZXh0cmFjdCxcblx0XHRcdFx0XHR1cmw6IFwiaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvP2N1cmlkPVwiICsgcGFnZXNbcHJvcF0ucGFnZWlkLFxuXHRcdFx0XHR9O1xuXHRcdFx0XHRmb3JtYXR0ZWRQYWdlcy5wdXNoKG5ld1BhZ2UpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZvcm1hdHRlZFBhZ2VzO1xuXHRcdH1cblxuXHRcdHJldHVybiB7XG5cdFx0XHRwYWdlc0Zyb21XaWtpSnNvbjogcGFnZXNGcm9tV2lraUpzb24sXG5cdFx0fTtcblx0fSkoKTtcblxuXHR2YXIgd2lraVNlYXJjaGVyID0gKGZ1bmN0aW9uKHdpa2lKc29uRm9ybWF0dGVyKXtcblx0XHR2YXIgb2Zmc2V0ID0gMDtcblx0XHR2YXIgbGltaXQgPSAxMDtcblx0XHR2YXIgc2VhcmNoID0gXCJcIjtcblx0XHR2YXIgYXBpQmFzZSA9IFwiaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3cvYXBpLnBocD9mb3JtYXQ9anNvbiZhY3Rpb249cXVlcnkmZ2VuZXJhdG9yPXNlYXJjaCZnc3JuYW1lc3BhY2U9MCZwcm9wPWV4dHJhY3RzJmV4aW50cm8mZXhwbGFpbnRleHQmZXhzZW50ZW5jZXM9MSZleGxpbWl0PW1heFwiXG5cdFx0dmFyIGxpbWl0UGFyYW0gPSBcIiZnc3JsaW1pdD1cIjtcblx0XHR2YXIgb2Zmc2V0UGFyYW0gPSBcIiZnc3JvZmZzZXQ9XCI7XG5cdFx0dmFyIHNlYXJjaFBhcmFtID0gXCImZ3Nyc2VhcmNoPVwiO1xuXG5cdFx0Ly9DYWNoZSBET01cblx0XHR2YXIgJHNlYXJjaCA9ICQoXCIjc2VhcmNoLXRleHRcIik7XG5cblx0XHQvL2JpbmQgZXZlbnRzXG5cdFx0JHNlYXJjaC5vbignc2VhcmNoJywgc2VhcmNoRmlyZWQpO1xuXHRcdGV2ZW50cy5zdWJzY3JpYmUoJ2JvdHRvbU9mUGFnZScsIGJvdHRvbU9mUGFnZSk7XG5cblx0XHRmdW5jdGlvbiBzZWFyY2hGaXJlZCgpIHtcblx0XHRcdG9mZnNldCA9IDA7XG5cdFx0XHRzZWFyY2ggPSAkc2VhcmNoLnZhbCgpO1xuXHRcdFx0Y2xlYXJTZWFyY2goKTtcblx0XHRcdGdldE5leHRXaWtpcGVkaWFRdWVyeSgpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGNsZWFyU2VhcmNoKCkge1xuXHRcdFx0ZXZlbnRzLmVtaXQoXCJjbGVhclNlYXJjaFwiLCBbXSk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZ2V0TmV4dFdpa2lwZWRpYVF1ZXJ5KCkge1xuXHRcdFx0aWYgKCFzZWFyY2gpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgcXVlcnlTdHIgPSBhcGlCYXNlICsgbGltaXRQYXJhbSArIGxpbWl0ICsgb2Zmc2V0UGFyYW0gKyBvZmZzZXQgKyBzZWFyY2hQYXJhbSArIHNlYXJjaDtcblx0XHRcdHZhciBxdWVyeSA9ICQuZ2V0SlNPTihxdWVyeVN0cik7XG5cdFx0XHRldmVudHMuZW1pdCgncXVlcmllZFBhZ2VzJywgbnVsbCk7XG5cdFx0XHQvLyBUT0RPIGhhbmRsZSBlcnJvclxuXHRcdFx0cXVlcnkuZG9uZShoYW5kbGVXaWtpcGVkaWFEYXRhKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBoYW5kbGVXaWtpcGVkaWFEYXRhKGRhdGEpIHtcblx0XHRcdHZhciBwYWdlcyA9IHdpa2lKc29uRm9ybWF0dGVyLnBhZ2VzRnJvbVdpa2lKc29uKGRhdGEpO1xuXHRcdFx0b2Zmc2V0ICs9IHBhZ2VzLmxlbmd0aDtcblx0XHRcdGV2ZW50cy5lbWl0KFwidXBkYXRlUXVlcnlSZXN1bHRzXCIsIHBhZ2VzKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBib3R0b21PZlBhZ2UoKXtcblx0XHRcdGdldE5leHRXaWtpcGVkaWFRdWVyeSgpO1xuXHRcdH1cblx0fSkod2lraVBhZ2VKc29uRm9ybWF0dGVyKTtcblxuXG5cdHZhciBwYWdlVmlld2VyID0gKGZ1bmN0aW9uKCl7XG5cdFx0dmFyIHBhZ2VzID0gW107XG5cblx0XHQvL2NhY2hlIERPTVxuXHRcdHZhciAkdWwgPSAkKFwiI3Jlc3VsdC1saXN0XCIpO1xuXHRcdHZhciB0ZW1wbGF0ZSA9ICR1bC5maW5kKFwiI3BhZ2UtdGVtcGxhdGVcIikuaHRtbCgpO1xuXG5cdFx0Ly9iaW5kIGV2ZW50c1xuXHRcdGV2ZW50cy5zdWJzY3JpYmUoJ3VwZGF0ZVF1ZXJ5UmVzdWx0cycsIGFkZFBhZ2VzKTtcblx0XHRldmVudHMuc3Vic2NyaWJlKCdjbGVhclNlYXJjaCcsIGNsZWFyUGFnZXMpO1xuXHRcdF9yZW5kZXIoKTtcblxuXHRcdGZ1bmN0aW9uIF9yZW5kZXIoKSB7XG5cdFx0XHQkdWwuaHRtbChNdXN0YWNoZS5yZW5kZXIodGVtcGxhdGUsIHtwYWdlczogcGFnZXN9KSk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gYWRkUGFnZXModmFsdWUpIHtcblx0XHRcdHBhZ2VzID0gcGFnZXMuY29uY2F0KHZhbHVlKTtcblx0XHRcdGV2ZW50cy5lbWl0KCdhZGRlZFBhZ2VzJywgbnVsbCk7XG5cdFx0XHRfcmVuZGVyKCk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gY2xlYXJQYWdlcygpIHtcblx0XHRcdHBhZ2VzID0gW107XG5cdFx0XHRfcmVuZGVyKCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGFkZFBhZ2VzOiBhZGRQYWdlcyxcblx0XHRcdGNsZWFyUGFnZXM6IGNsZWFyUGFnZXMsXG5cdFx0fTtcblx0fSkoKTtcbn0od2luZG93LmpRdWVyeSwgd2luZG93LCBkb2N1bWVudCkpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vanMvc2NyaXB0LmpzXG4vLyBtb2R1bGUgaWQgPSAxXG4vLyBtb2R1bGUgY2h1bmtzID0gMCIsIihmdW5jdGlvbigkLCB3aW5kb3csIGRvY3VtZW50KSB7XHRcblx0dmFyIGV2ZW50cyA9IHJlcXVpcmUoJy4vcHVic3ViLmpzJyk7XG5cblx0dmFyIHNjcm9sbCA9IChmdW5jdGlvbigpe1xuXHRcdHZhciB3aW4gPSAkKHdpbmRvdyk7XG5cblx0XHQvL2NhY2hlIERPTVxuXHRcdHZhciAkbG9hZGluZyA9ICQoJyNsb2FkaW5nJyk7XG5cblx0XHQvL0JpbmQgZXZlbnRzXG5cdFx0d2luLnNjcm9sbChjaGVja0JvdHRvbU9mUGFnZSk7XG5cdFx0ZXZlbnRzLnN1YnNjcmliZSgnYWRkZWRQYWdlcycsIGhpZGVMb2FkaW5nKTtcblx0XHRldmVudHMuc3Vic2NyaWJlKCdxdWVyaWVkUGFnZXMnLCBzaG93TG9hZGluZyk7XG5cblx0XHRmdW5jdGlvbiBjaGVja0JvdHRvbU9mUGFnZSgpIHtcblx0XHRcdGlmICgkKGRvY3VtZW50KS5oZWlnaHQoKSAtIHdpbi5oZWlnaHQoKSA9PSB3aW4uc2Nyb2xsVG9wKCkpIHtcblx0XHRcdFx0ZXZlbnRzLmVtaXQoXCJib3R0b21PZlBhZ2VcIiwgbnVsbCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gc2hvd0xvYWRpbmcoKSB7XG5cdFx0XHQkbG9hZGluZy5zaG93KCk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gaGlkZUxvYWRpbmcoKSB7XG5cdFx0XHQkbG9hZGluZy5oaWRlKCk7XG5cdFx0fVxuXHR9KSgpO1xufSh3aW5kb3cualF1ZXJ5LCB3aW5kb3csIGRvY3VtZW50KSk7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9qcy9zY3JvbGwuanNcbi8vIG1vZHVsZSBpZCA9IDJcbi8vIG1vZHVsZSBjaHVua3MgPSAwIiwicmVxdWlyZSgnLi9zY3JvbGwuanMnKTtcbnJlcXVpcmUoJy4vc2NyaXB0LmpzJyk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2pzL3NjcmlwdHMuanNcbi8vIG1vZHVsZSBpZCA9IDNcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==